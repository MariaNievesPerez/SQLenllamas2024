-- ¿Cuántos días ha visitado el restaurante cada cliente?
WITH CTE AS(
SELECT 
    CUSTOMER_ID,
    COUNT(ORDER_DATE) DIAS_VISITADOS
    FROM
    SQL_EN_LLAMAS.CASE01.SALES S
    GROUP BY CUSTOMER_ID
)
SELECT 
     ME.CUSTOMER_ID CLIENTE
    ,IFNULL(DIAS_VISITADOS, 0) "DÍAS VISITADOS"
FROM
    SQL_EN_LLAMAS.CASE01.SALES S
    FULL JOIN SQL_EN_LLAMAS.CASE01.MEMBERS ME
    ON S.CUSTOMER_ID=ME.CUSTOMER_ID
    FULL JOIN CTE
    ON ME.CUSTOMER_ID = CTE.CUSTOMER_ID
GROUP BY ME.CUSTOMER_ID, DIAS_VISITADOS;
